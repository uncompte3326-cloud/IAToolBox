<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reformulateur de Texte IA Gratuit</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>IAtoolbox üõ†Ô∏è</h1>
        <nav>
            <a href="index.html">Accueil</a>
            <a href="text_generator.html">Texte IA</a>
            <a href="pseudo_generator.html">Pseudos</a>
            <a href="text_rewriter.html">Reformulateur</a>
            <a href="contact.html">Contact</a>
        </nav>
    </header>

    <div class="tool-container">
        <h2>üìù Reformulateur de Texte</h2>
        <p>Collez votre texte et l'IA le r√©√©crira de mani√®re unique, tout en conservant le sens original.</p>
        
        <textarea id="input" rows="8" placeholder="Collez le texte √† reformuler ici..."></textarea>
        <button onclick="rewriteText()">Reformuler</button>
        
        <h3>R√©sultat :</h3>
        <div id="output">Le texte reformul√© appara√Ætra ici.</div>
    </div>

    <div class="ad-placeholder">
        Espace Publicitaire 320x100
    </div>

   <script>
// Le mod√®le n'est plus un secret, on peut le laisser ici.
const HF_MODEL = "gpt2"; 

async function generateText() {
    const input = document.getElementById("input").value;
    const output = document.getElementById("output");
    output.innerText = "G√©n√©ration en cours via Netlify Function... Patientez.";

    if (!input.trim()) {
        output.innerText = "Veuillez entrer une id√©e ou un d√©but de phrase.";
        return;
    }

    try {
        // üö® NOUVEAU : On appelle la fonction Netlify √† l'adresse /.netlify/functions/generate
        const res = await fetch("/.netlify/functions/generate", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                model: HF_MODEL, 
                input: input,
                parameters: { 
                    max_new_tokens: 100, // Limite la taille de la r√©ponse
                    return_full_text: false 
                }
            }),
        });
        
        const result = await res.json();
        
        if (res.ok) {
            // Affiche l'entr√©e + le texte g√©n√©r√© (pour la compl√©tion)
            output.innerText = input + result[0].generated_text.trim();
        } else if (result.error) {
             output.innerText = `Erreur de l'API : ${result.error}. (V√©rifiez la cl√© sur Netlify)`;
        } else {
            output.innerText = "Une erreur inconnue est survenue lors de la g√©n√©ration.";
        }

    } catch (e) {
        console.error(e);
        output.innerText = "√âchec de la connexion. Le site est en ligne, le probl√®me est dans la variable Netlify ou l'API.";
    }
}
</script>
</body>
</html>
